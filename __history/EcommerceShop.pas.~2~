unit EcommerceApp;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,
  Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Xml.XMLDoc, Xml.XMLIntf,
  Vcl.StdCtrls;

type
  TClothingItem = class
  public
    Name: string;
    Size: string;
    Price: Currency;
    constructor Create(const AName, ASize: string; APrice: Currency);
  end;

  TForm1 = class(TForm)
    ListBoxProducts: TListBox;
    procedure FormCreate(Sender: TObject);
  private
    FProducts: TList;
    procedure LoadProductsFromXML(const FileName: string);
    procedure SaveProductsToXML(const FileName: string);
    procedure ShowProducts;
  public

  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

constructor TClothingItem.Create(const AName, ASize: string; APrice: Currency);
begin
  Name := AName;
  Size := ASize;
  Price := APrice;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  FProducts := TList.Create;
  LoadProductsFromXML('products.xml');
  ShowProducts;
end;

procedure TForm1.LoadProductsFromXML(const FileName: string);
var
  Doc: IXMLDocument;
  Node, ItemNode: IXMLNode;
  Name, Size: string;
  Price: Currency;
  i: Integer;
begin
  if not FileExists(FileName) then Exit;

  Doc := TXMLDocument.Create(nil);
  try
    Doc.LoadFromFile(FileName);
    Doc.Active := True;
    Node := Doc.DocumentElement;

    for i := 0 to Node.ChildNodes.Count - 1 do
    begin
      ItemNode := Node.ChildNodes[i];
      Name := ItemNode.ChildNodes['Name'].Text;
      Size := ItemNode.ChildNodes['Size'].Text;
      Price := StrToCurrDef(ItemNode.ChildNodes['Price'].Text, 0.0);

      FProducts.Add(TClothingItem.Create(Name, Size, Price));
    end;
  finally
    Doc := nil;
  end;
end;

procedure TForm1.SaveProductsToXML(const FileName: string);
var
  Doc: IXMLDocument;
  RootNode, ItemNode: IXMLNode;
  i: Integer;
  Item: TClothingItem;
begin
  Doc := TXMLDocument.Create(nil);
  try
    Doc.Active := True;
    Doc.Version := '1.0';
    RootNode := Doc.AddChild('Products');

    for i := 0 to FProducts.Count - 1 do
    begin
      Item := TClothingItem(FProducts[i]);
      ItemNode := RootNode.AddChild('Product');
      ItemNode.AddChild('Name').Text := Item.Name;
      ItemNode.AddChild('Size').Text := Item.Size;
      ItemNode.AddChild('Price').Text := CurrToStr(Item.Price);
    end;

    Doc.SaveToFile(FileName);
  finally
    Doc := nil;
  end;
end;

procedure TForm1.ShowProducts;
var
  i: Integer;
  Item: TClothingItem;
begin
  ListBoxProducts.Items.Clear;

  for i := 0 to FProducts.Count - 1 do
  begin
    Item := TClothingItem(FProducts[i]);
    ListBoxProducts.Items.Add(
      Format('%s - Size: %s - Price: $%.2f', [Item.Name, Item.Size, Item.Price])
    );
  end;
end;

end.

